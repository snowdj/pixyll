---
published: true
layout: post
category: pandas
---
This post includes some materials about pandas.

## read excel 

pd.read_excel('file_name.xls',
skiprows=5,
parse_cols = 'B,D:E',
skip_footer=4
)
   
    
![excel](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/gwbw659XEeav5QpTGIv-Pg_538f2b2fc7f08419f7533c614f1da93f_Capture.PNG?expiry=1478736000000&hmac=SEKuUGWscyRKTSyXMb5a9C6DVjMgBrwv6ZOZi4XmiUc)

as you see skiprows takes the number of the row where data starts -1

skip footer takes the number of rows from end of the excel sheet (here its row 13) to the end of the data (here its row 9) 13-9

parse_cols take the columns to be parsed. here we wanted to skip column C so we used B,D:E


## Change columns name

for col in df.columns:
    if col[:2]=='01':
        df.rename(columns={col:'Gold' + col[4:]}, inplace=True)
    if col[:2]=='02':
        df.rename(columns={col:'Silver' + col[4:]}, inplace=True)
    if col[:2]=='03':
        df.rename(columns={col:'Bronze' + col[4:]}, inplace=True)
    if col[:1]=='№':
        df.rename(columns={col:'#' + col[1:]}, inplace=True) 
        
## str.split


    单分隔符

    字符串 str = "study,python"
    column = str.split(",")
    结果：['study','python'] 比较简单

    字符串中含有多个分隔符（重点）

    str = "i  am studying,python"
    字符串中还有两个空格，单个空格以及逗号三个分割符
    首先import re
    column = re.split('  | |,',str)
    结果：['i', 'am', 'studying', 'python'] 正确分割
    注意：当字符串同时被多个空格以及单个空格分割是，在进行正则分割时，先写多空格
    
    http://python3-cookbook.readthedocs.io/zh_CN/latest/c02/p01_split_string_on_multiple_delimiters.html
    
    
    

    \d{3}表示匹配3个数字，例如'010'；

    \s可以匹配一个空格（也包括Tab等空白符），所以\s+表示至少有一个空格，例如匹配' '，' '等；

    \d{3,8}表示3-8个数字，例如'1234567'。


## .isin() function


## str.startswith()

 use .str.startswith() in your query.

http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.startswith.htm

## Lambda

## groupby
generate new index for group object

return Sumlevel50_county.groupby(['STNAME'])["CENSUS2010POP"].apply(lambda col:sum(list(sorted(col.values.tolist())[-3:]))).nlargest(3).index.values.tolist()
